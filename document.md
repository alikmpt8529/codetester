# コーディング規約チェッカー ドキュメント

## プロジェクト概要

このプロジェクトは、C言語のソースコードがコーディング規約に準拠しているかをチェックするSwiftUIアプリケーションです。

**作成日**: 2025年11月4日  
**プラットフォーム**: macOS (SwiftUI)  
**対象言語**: C言語

## 機能仕様

### 基本機能

#### 1. 主要コーディング規約ファイルのアップロード
- **対象ファイル**: `.txt`ファイル
- **動作**: ファイル選択後、ファイル名を画面に表示
- **用途**: 主要なコーディング規約の定義

#### 2. 二次コーディング規約ファイルのアップロード（任意）
- **対象ファイル**: `.txt`ファイル
- **動作**: ファイル選択後、ファイル名を画面に表示
- **用途**: 課題用の規約定義（課題1〜4を含む）

#### 3. Cソースファイルのアップロード
- **対象ファイル**: `.c`ファイル
- **動作**: ファイル選択後、ファイル名を画面に表示
- **用途**: チェック対象のCソースコード

#### 4. プログラムチェック機能
**チェック順序**:
1. 二次規約ファイルによるチェック（存在する場合）
2. 主要規約ファイルによるチェック

**出力**:
- 違反がある場合: 違反内容を記載した`.txt`ファイルを生成
- 違反がない場合: "correct"を返す

### 追加機能

#### 課題生成機能
- **対象**: 二次規約ファイル内の課題1〜4
- **動作**: C言語ファイルのテンプレートを課題番号順に生成
- **出力**: 各課題に対応するCソースファイル

#### 修正版ダウンロード機能
- **対象**: 規約違反があるソースコード
- **動作**: 違反箇所にコメントを追加したCファイルを生成
- **UI**: ダウンロードボタンを提供

## アーキテクチャ

### ファイル構成
```
codetester/
├── codetesterApp.swift          # アプリケーションエントリーポイント
├── ContentView.swift            # メインUI
├── Models.swift                 # データモデル定義
├── CodingRuleChecker.swift     # 規約チェック機能
├── CodeCorrector.swift         # コード修正機能
├── UIComponents.swift          # UI コンポーネント
└── Item.swift                  # アイテム管理
```

### データモデル

#### Violation
```swift
struct Violation {
    let line: Int           // 違反行番号
    let description: String // 違反内容
    let rule: String       // 適用規約
}
```

#### CheckResult
```swift
struct CheckResult {
    let isCorrect: Bool          // 規約準拠の可否
    let violations: [Violation]  // 違反リスト
    let correctedCode: String?   // 修正版コード
}
```

#### AssignmentTemplate
```swift
struct AssignmentTemplate {
    static let templates: [String: String] // 課題テンプレート辞書
}
```

## 使用方法

### 基本的な使用フロー

1. **アプリケーション起動**
   - Xcodeでプロジェクトを開く
   - Run（⌘+R）でアプリケーションを起動

2. **規約ファイルのアップロード**
   - "主要規約ファイル (.txt)"ボタンをクリック
   - 主要なコーディング規約ファイルを選択
   - （任意）"二次規約ファイル (.txt)"ボタンをクリック
   - 課題用規約ファイルを選択

3. **ソースファイルのアップロード**
   - "Cソースファイル (.c)"ボタンをクリック
   - チェック対象のCファイルを選択

4. **チェック実行**
   - "チェック実行"ボタンをクリック
   - 結果を確認

5. **結果の処理**
   - 違反がある場合: レポートファイルをダウンロード
   - 修正版が必要な場合: "修正版ダウンロード"ボタンを使用

### 課題生成機能の使用方法

1. 二次規約ファイルに課題1〜4の規約を記載
2. "課題生成"ボタンをクリック
3. 各課題のテンプレートファイルがダウンロード可能になる

## チェック機能詳細

### 基本チェック項目

#### セミコロンチェック
- `printf`, `scanf`, `return`文でのセミコロン有無
- 変数宣言でのセミコロン有無

#### インデントチェック
- 4スペースインデントの確認
- ブロック内のインデント統一性

#### 構文チェック
- 基本的なC言語構文の確認
- 関数定義の形式チェック

### 課題固有チェック

#### 課題1: Hello World
- `printf`関数の使用確認
- "Hello"文字列の出力確認

#### 課題2: 変数使用
- `int`型変数の宣言確認
- 変数を使った計算の実装確認

#### 課題3: 条件分岐
- `if`文の使用確認
- 条件分岐ロジックの実装確認

#### 課題4: ループ処理
- `for`文または`while`文の使用確認
- ループ処理の実装確認

## エラーハンドリング

### ファイル関連エラー
- 不正なファイル形式
- ファイル読み込みエラー
- 空ファイルエラー

### チェック処理エラー
- 規約ファイル解析エラー
- ソースコード解析エラー
- メモリ不足エラー

## 出力形式

### 違反レポート形式
```
コーディング規約違反レポート
==============================

1. 行 X: 違反内容の説明
   規約: 適用された規約名

2. 行 Y: 違反内容の説明
   規約: 適用された規約名
```

### 修正版ファイル形式
```c
// 違反: セミコロンが不足しています
printf("Hello, World!")

// 違反: インデントが正しくありません
    return 0;
```

## 開発・デバッグ情報

### ビルド要件
- Xcode 14.0以上
- macOS 12.0以上
- Swift 5.7以上

### デバッグ機能
- コンソール出力によるログ確認
- 処理時間の計測
- メモリ使用量の監視

### テスト項目
- 基本的なファイルアップロード
- 各種規約チェック機能
- エラー処理の動作確認
- 課題生成機能の確認

## 今後の拡張予定

### 機能拡張
- 他プログラミング言語への対応
- より詳細な規約チェック
- リアルタイムチェック機能
- クラウド連携機能

### UI/UX改善
- ドラッグ&ドロップ対応
- プレビュー機能
- テーマ機能
- 多言語対応

## トラブルシューティング

### よくある問題

**問題**: ファイルが選択できない
- **解決策**: ファイル形式（.txt, .c）を確認

**問題**: チェック結果が表示されない
- **解決策**: 規約ファイルとソースファイルの両方が選択されているか確認

**問題**: アプリがクラッシュする
- **解決策**: ファイルサイズを確認（大きすぎる場合は分割）

### ログ確認方法
1. Xcodeのコンソールタブを開く
2. アプリ実行中のログを確認
3. エラーメッセージから問題を特定

---

**最終更新**: 2025年11月4日  
**バージョン**: 1.0.0